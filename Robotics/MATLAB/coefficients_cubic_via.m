function [c1, c2] = coefficients_cubic_via(theta0,theta1,thetaf,t1,tf)
% Calculates the coefficients of the two cubic polynomials
% Input     Type        Description
% theta0    1x1 double  start angle position
% theta1    1x1 double  via angle position
% thetaf    1x1 double  final angle position
% t1        1x1 double  via time
% tf        1x1 double  finish time
% Output    Type        Description
% c1        4x1 double  coefficients of first cubic polynomial
% c2        4x1 double  coefficients of second cubic polynomial
c = zeros(8,1);
M = [0, 0, 0, 1, 0, 0, 0, 0;...
     t1^3, t1^2, t1, 1, 0, 0, 0, 0;...
     0, 0, 1, 0, 0, 0, 0, 0;...
     0, 0, 0, 0, 0, 0, 0, 1;...
     0, 0, 0, 0, (tf-t1)^3, (tf-t1)^2 , tf-t1, 1;...
     0, 0, 0, 0, 3*(tf-t1)^2, 2*(tf-t1) , 1, 0;...
     3*t1^2, 2*t1, 1, 0, 0, 0, -1, 0;...
     6*t1, 2, 0, 0, 0, -2, 0, 0];
 
x = [theta0;...
     theta1;...
     0;...
     theta1;...
     thetaf;...
     0;...
     0;...
     0];
c = M^-1*x;
c1 = [c(1); c(2); c(3); c(4)];
c2 = [c(5); c(6); c(7); c(8)];
end

