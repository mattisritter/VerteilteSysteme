function [c1, c2] = coefficients_quintic_via(theta0,theta1,thetaf,t1,tf)
% Calculates the coefficients of the two quintic polynomials
% Input     Type        Description
% theta0    1x1 double  start angle position
% theta1    1x1 double  via angle position
% thetaf    1x1 double  final angle position
% t1        1x1 double  via time
% tf        1x1 double  finish time
% Output    Type        Description
% c1        6x1 double  coefficients of first quintic polynomial
% c2        6x1 double  coefficients of second quintic polynomial
c = zeros(12,1);
M = [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0;...
     t1^5, t1^4, t1^3, t1^2, t1, 1, 0, 0, 0, 0, 0, 0;...
     0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0;...
     0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0;...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1;...
     0, 0, 0, 0, 0, 0, (tf-t1)^5, (tf-t1)^4, (tf-t1)^3, (tf-t1)^2 , tf-t1, 1;...
     0, 0, 0, 0, 0, 0, 5*(tf-t1)^4, 4*(tf-t1)^3, 3*(tf-t1)^2, 2*(tf-t1) , 1, 0;...
     0, 0, 0, 0, 0, 0, 20*(tf-t1)^3, 12*(tf-t1)^2, 6*(tf-t1), 2, 0, 0;...
     5*t1^4, 4*t1^3, 3*t1^2, 2*t1, 1, 0, 0, 0, 0, 0, -1, 0;...
     20*t1^3, 12*t1^2, 6*t1, 2, 0, 0, 0, 0, 0, -2, 0, 0;...
     60*t1^2, 24*t1, 6, 0, 0, 0, 0, 0, -6, 0, 0, 0;...
     120*t1, 24, 0, 0, 0, 0, 0, -24, 0, 0, 0, 0];
x = [theta0;...
     theta1;...
     0;...
     0;...
     theta1;...
     thetaf;...
     0;...
     0;...
     0;...
     0;...
     0;...
     0];
c = M^-1*x;
c1 = [c(1); c(2); c(3); c(4); c(5); c(6)];
c2 = [c(7); c(8); c(9); c(10); c(11); c(12)];
end

